<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- links para exportar a excel -->
    <script src="https://unpkg.com/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
    <script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script>
    <title>Document</title>
   
</head>
<style>
    table,th,tr,td{
        border: 1px solid black;
    }
</style>
<body>
    <h1>lista de examenes</h1>
    <button id="btnExportar" class="btn btn-success">
         Exportar datos a Excel
    </button>
    <table id="tabla">
        <thead>
            <th>Fecha y hora</th>
            <th>Dni</th>
            <th>Resultado</th>
            <th>P1</th>
            <th>P2</th>
            <th>P3</th>
            <th>P4</th>
            <th>P5</th>
            <th>P6</th>
            <th>P7</th>
            <th>P8</th>
            <th>P9</th>
            <th>P10</th>
            <th>P11</th>
            <th>P12</th>
            <th>P13</th>
            <th>P14</th>
            <th>P15</th>
            <th>P16</th>
            <th>P17</th>
            <th>P18</th>
            <th>P19</th>
            <th>P20</th>
        </thead>
        <tbody>
            <tr th:each="ex : ${examenes}">
            <td th:text="${ex.fechaDeRealizacion}">Fecha y hora</td>
            <td th:text="${ex.dni}">Dni</td>
            <td th:text="${ex.resultado}">Resultado</td>
            <td th:text="${ex.p1}">P1</td>
            <td th:text="${ex.p2}">P2</td>
            <td th:text="${ex.p3}">P3</td>
            <td th:text="${ex.p4}">P4</td>
            <td th:text="${ex.p5}">P5</td>
            <td th:text="${ex.p6}">P6</td>
            <td th:text="${ex.p7}">P7</td>
            <td th:text="${ex.p8}">P8</td>
            <td th:text="${ex.p9}">P9</td>
            <td th:text="${ex.p10}">P10</td>
            <td th:text="${ex.p11}">P11</td>
            <td th:text="${ex.p12}">P12</td>
            <td th:text="${ex.p13}">P13</td>
            <td th:text="${ex.p14}">P14</td>
            <td th:text="${ex.p15}">P15</td>
            <td th:text="${ex.p16}">P16</td>
            <td th:text="${ex.p17}">P17</td>
            <td th:text="${ex.p18}">P18</td>
            <td th:text="${ex.p19}">P19</td>
            <td th:text="${ex.p20}">P20</td>
            </tr>
        </tbody>
    </table>
    <!-- script para exportar a excel -->
<script>
    const $btnExportar = document.querySelector("#btnExportar"),
        $tabla = document.querySelector("#tabla");

    $btnExportar.addEventListener("click", function() {
        let tableExport = new TableExport($tabla, {
            exportButtons: false, // No queremos botones
            filename: "Reporte de examenes", //Nombre del archivo de Excel
            sheetname: "Reporte de examenes", //TÃ­tulo de la hoja
        });
        let datos = tableExport.getExportData();
        let preferenciasDocumento = datos.tabla.xlsx;
        tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);
    });
</script>
</body>

</html>